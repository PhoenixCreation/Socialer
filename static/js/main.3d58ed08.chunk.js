(this.webpackJsonpsocialer=this.webpackJsonpsocialer||[]).push([[0],{53:function(e,a,t){e.exports=t(76)},58:function(e,a,t){},59:function(e,a,t){},70:function(e,a,t){},76:function(e,a,t){"use strict";t.r(a);var n=t(0),o=t.n(n),l=t(15),c=t.n(l),r=(t(58),t(5)),s=(t(59),t(101)),i=t(16),u=t.n(i),m=(t(70),t(96)),p=t(100),d=t(97),f=t(46),g=t.n(f),h=t(45),v=t.n(h),E=u.a.initializeApp({apiKey:"AIzaSyA79AKi494FNiNFUNjCBqqOneDthQMhpUE",authDomain:"socialer-ab176.firebaseapp.com",databaseURL:"https://socialer-ab176.firebaseio.com",projectId:"socialer-ab176",storageBucket:"socialer-ab176.appspot.com",messagingSenderId:"62578825669",appId:"1:62578825669:web:e65a6d0979b8c3f07093ac",measurementId:"G-R00TB46SH7"}).firestore(),b=u.a.auth(),y=u.a.storage();var _=function(e){var a=e.postId,t=e.crntuser,l=e.username,c=e.userAvatar,i=e.caption,f=e.imageURL,h=e.comments,b=Object(n.useState)(""),y=Object(r.a)(b,2),_=y[0],N=y[1],O=Object(n.useState)(!1),j=Object(r.a)(O,2),w=j[0],U=j[1],S=Object(n.useState)(0),k=Object(r.a)(S,2),C=k[0],I=k[1];Object(n.useEffect)((function(){E.collection("posts").doc(a).get().then((function(e){var a=e.data().likes;I(a.length),t&&a.includes(t.displayName)&&U(!0)}))}),[]);var L=function(e){e.preventDefault(),E.collection("posts").doc(a).get().then((function(e){var n=e.data().likes;n.includes(t.displayName)?(U(!1),E.collection("posts").doc(a).update({likes:u.a.firestore.FieldValue.arrayRemove(t.displayName)}),I(n.length-1)):(U(!0),E.collection("posts").doc(a).update({likes:u.a.firestore.FieldValue.arrayUnion(t.displayName)}),I(n.length+1))}))};return o.a.createElement("div",{className:"post"},o.a.createElement("div",{className:"post__header"},o.a.createElement(s.a,{src:c,alt:l,className:"post__headerAvatar"}),o.a.createElement("h3",null,l)),o.a.createElement("img",{className:"post__image",src:f,alt:"Image not found"}),o.a.createElement("div",{className:"post__likesection"},(null===t||void 0===t?void 0:t.displayName)&&w?o.a.createElement(m.a,{onClick:L},o.a.createElement(v.a,{color:"secondary"})):(null===t||void 0===t?void 0:t.displayName)&&!w?o.a.createElement(m.a,{onClick:L},o.a.createElement(g.a,{color:"secondary"})):o.a.createElement("p",null),o.a.createElement("div",{className:"post__likestotal"},C)),o.a.createElement("div",{className:"post__footer"},o.a.createElement("strong",null,l,":"),i),o.a.createElement("div",{className:"post__commentbox"},h.map((function(e){return o.a.createElement("div",{className:"post__comment"},o.a.createElement("strong",null,e.username)," : ",e.commenttext)})),(null===t||void 0===t?void 0:t.displayName)?o.a.createElement("form",{className:"post__commentadder"},o.a.createElement(p.a,{type:"text",placeholder:"share your thoughs...",value:_,onChange:function(e){return N(e.target.value)}}),o.a.createElement(d.a,{type:"submit",onClick:function(e){e.preventDefault(),""!==_?E.collection("posts").doc(a).update({comments:u.a.firestore.FieldValue.arrayUnion({username:t.displayName,commenttext:_})}):alert("bhai kaik lakh pachi comment kar"),N("")}},"Comment")):o.a.createElement("p",null,"Login to comment")))};var N=function(e){var a=e.username,t=e.userAvatar,l=Object(n.useState)(""),c=Object(r.a)(l,2),s=c[0],i=c[1],m=Object(n.useState)(null),f=Object(r.a)(m,2),g=f[0],h=f[1],v=Object(n.useState)(0),b=Object(r.a)(v,2),_=b[0],N=b[1];return o.a.createElement("div",{className:"ImageUpload"},o.a.createElement(p.a,{type:"text",name:"caption",onChange:function(e){return i(e.target.value)},value:s,placeholder:"Enter your caption"}),o.a.createElement("progress",{value:_,max:"100"}),o.a.createElement(p.a,{type:"file",name:"image",onChange:function(e){e.target.files[0]&&h(e.target.files[0])}}),o.a.createElement(d.a,{onClick:function(){y.ref("Images/".concat(g.name)).put(g).on("state_changed",(function(e){var a=Math.round(e.bytesTransferred/e.totalBytes*100);N(a),console.log(e.bytesTransferred/e.totalBytes)}),(function(e){console.log(e)}),(function(){y.ref("Images").child(g.name).getDownloadURL().then((function(e){E.collection("posts").add({timestamp:u.a.firestore.FieldValue.serverTimestamp(),caption:s,imageURL:e,username:a,userAvatar:t,comments:[],likes:[]}).then((function(e){console.log(e.id),E.collection("userinfo").where("username","==",a).get().then((function(a){a.forEach((function(a){E.collection("userinfo").doc(a.id).update({posts:u.a.firestore.FieldValue.arrayUnion(e.id)})}))}))})),alert("Posted..."),N(0),i(""),h(null)}))}))}},"Upload"))};var O=function(e){var a=e.userinfoID,t=Object(n.useState)(null),l=Object(r.a)(t,2),c=l[0],s=l[1];return Object(n.useEffect)((function(){a&&E.collection("userinfo").onSnapshot((function(e){e.forEach((function(e){e.id==a&&s(e.data())}))}))}),[a]),o.a.createElement("div",{className:"UserPopUp"},(null===c||void 0===c?void 0:c.username)?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"UserPopUp__avatar"},c.photoURL),o.a.createElement("div",{className:"UserPopUp__username"},c.username),o.a.createElement("div",{className:"UserPopUp__followers"},c.followers.length),o.a.createElement("div",{className:"UserPopUp__followings"},c.following.length),o.a.createElement("div",{className:"UserPopUp__posts"},c.posts.length)):o.a.createElement(o.a.Fragment,null,"lochA"))},j=t(98),w=t(99),U=t(47),S=t.n(U);function k(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var C=Object(j.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #aa4488",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));var I=function(){var e=C(),a=Object(n.useState)([]),t=Object(r.a)(a,2),l=t[0],c=t[1],i=Object(n.useState)(!1),u=Object(r.a)(i,2),m=u[0],f=u[1],g=Object(n.useState)(!1),h=Object(r.a)(g,2),v=h[0],j=h[1],U=Object(n.useState)(!1),I=Object(r.a)(U,2),L=I[0],A=I[1],R=Object(n.useState)(!1),P=Object(r.a)(R,2),x=P[0],D=P[1],B=Object(n.useState)(""),F=Object(r.a)(B,2),T=F[0],V=F[1],W=Object(n.useState)(""),M=Object(r.a)(W,2),q=M[0],z=M[1],H=Object(n.useState)(""),J=Object(r.a)(H,2),K=J[0],G=J[1],Q=Object(n.useState)(null),Y=Object(r.a)(Q,2),$=Y[0],X=Y[1],Z=Object(n.useState)(null),ee=Object(r.a)(Z,2),ae=ee[0],te=ee[1],ne=Object(n.useState)(null),oe=Object(r.a)(ne,2),le=oe[0],ce=oe[1],re=Object(n.useState)(null),se=Object(r.a)(re,2),ie=se[0],ue=se[1],me=o.a.useState(k),pe=Object(r.a)(me,1)[0];return Object(n.useEffect)((function(){var e=b.onAuthStateChanged((function(e){if(e){if(te(e),null!=e.photoURL&&ce(e.photoURL),e.displayName&&E.collection("userinfo").where("username","==",e.displayName).onSnapshot((function(e){ue(e.docs.map((function(e){return e.id})))})),!e.displayName)return e.updateProfile({displayName:T})}else ue(null),te(null)}));return function(){e()}}),[ae,T]),Object(n.useEffect)((function(){E.collection("posts").onSnapshot((function(e){c(e.docs.map((function(e){return{id:e.id,post:e.data()}})))}))}),[]),Object(n.useEffect)((function(){}),[ae]),o.a.createElement("div",{className:"app"},(null===ae||void 0===ae?void 0:ae.displayName)?o.a.createElement("div",{className:"app__postButton"},o.a.createElement(d.a,{type:"button",name:"button",onClick:function(){return A(!0)},endIcon:o.a.createElement(S.a,null)},"  Add")):o.a.createElement("h3",null,"Log in or SignUp to start adding your movements too.."),o.a.createElement(w.a,{open:L,onClose:function(){return A(!1)}},o.a.createElement("div",{style:pe,className:e.paper},(null===ae||void 0===ae?void 0:ae.displayName)?o.a.createElement(N,{username:ae.displayName,userAvatar:le}):o.a.createElement("h3",null,"You need to login... How am I supposed to allow you to post without login.."))),o.a.createElement(w.a,{open:m,onClose:function(){return f(!1)}},o.a.createElement("div",{style:pe,className:e.paper},o.a.createElement("div",{id:"simple-modal-description"},o.a.createElement("center",null,o.a.createElement("img",{className:"app__headerImage",src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png",alt:"logo"})),o.a.createElement("form",{className:"app_signUp"},o.a.createElement(p.a,{type:"text",placeholder:"username",value:T,onChange:function(e){return V(e.target.value)}}),o.a.createElement(p.a,{type:"email",placeholder:"email",value:K,onChange:function(e){return G(e.target.value)}}),o.a.createElement(p.a,{type:"password",placeholder:"password",value:q,onChange:function(e){return z(e.target.value)}}),o.a.createElement(p.a,{type:"file",name:"image",onChange:function(e){e.target.files[0]&&X(e.target.files[0])}}),o.a.createElement(d.a,{type:"submit",onClick:function(e){e.preventDefault(),b.createUserWithEmailAndPassword(K,q).then((function(e){e.user.updateProfile({displayName:T}),y.ref("ProfileImages/".concat(T)).put($).on("state_changed",(function(e){console.log(e.bytesTransferred/e.totalBytes)}),(function(e){alert(e.message)}),(function(){y.ref("ProfileImages").child(T).getDownloadURL().then((function(a){ce(a),e.user.updateProfile({photoURL:a}),E.collection("userinfo").add({email:K,username:T,photoURL:a,followers:[],following:[],posts:[]}),alert("user created successfully")}))}))})).catch((function(e){return alert(e.message)})),f(!1)}},"SIgn Up"))))),o.a.createElement(w.a,{open:v,onClose:function(){return j(!1)}},o.a.createElement("div",{style:pe,className:e.paper},o.a.createElement("div",{id:"simple-modal-description"},o.a.createElement("center",null,o.a.createElement("img",{className:"app__headerImage",src:"https://www.instagram.com/static/images/web/mobile_nav_type_logo.png/735145cfe0a4.png",alt:"logo"})),o.a.createElement("form",{className:"app_signUp"},o.a.createElement(p.a,{type:"email",placeholder:"email",value:K,onChange:function(e){return G(e.target.value)}}),o.a.createElement(p.a,{type:"password",placeholder:"password",value:q,onChange:function(e){return z(e.target.value)}}),o.a.createElement(d.a,{type:"submit",onClick:function(e){e.preventDefault(),b.signInWithEmailAndPassword(K,q).then((function(e){te(e),ce(e.user.photoURL),console.log(e)})).catch((function(e){return alert(e.message)})),j(!1)}},"SIgn In"))))),o.a.createElement(w.a,{open:x,onClose:function(){return D(!1)}},o.a.createElement("div",{style:pe,className:e.paper},o.a.createElement(O,{userinfoID:ie}))),o.a.createElement("div",{className:"app__header"},o.a.createElement("div",{className:"app__headerImage"},"Socialer"),o.a.createElement("div",{className:"app__headerLogin"},ae?o.a.createElement("div",{className:"app__headerRight"},o.a.createElement(s.a,{src:le,alt:T,onClick:function(){return D(!0)}}),o.a.createElement(d.a,{onClick:function(){return b.signOut()},id:"signup-btn"},"Log Out")):o.a.createElement("div",null,o.a.createElement(d.a,{onClick:function(){return j(!0)}},"Sign In"),o.a.createElement(d.a,{onClick:function(){return f(!0)}},"SignUp")))),l.map((function(e){var a=e.id,t=e.post;return o.a.createElement(_,{key:a,postId:a,crntuser:ae,username:t.username,userAvatar:t.userAvatar,caption:t.caption,imageURL:t.imageURL,comments:t.comments})})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.3d58ed08.chunk.js.map